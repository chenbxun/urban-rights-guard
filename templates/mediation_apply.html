{% extends "base.html" %}

{% block content %}
<div class="row mt-4">

    <div class="col-md-3 mb-4">
        <div class="card shadow-sm border-0">
            <div class="card-header bg-primary text-white fw-bold py-3">
                âš–ï¸ è°ƒè§£æœåŠ¡å¤§å…
            </div>
            <div class="list-group list-group-flush">
                <a href="/mediation/apply" class="list-group-item list-group-item-action py-3 d-flex justify-content-between align-items-center sidebar-active">
                    å¿«é€Ÿè°ƒè§£å…¥å£
                    <span class="badge bg-danger rounded-pill">Hot</span>
                </a>
                <a href="/mediation/status" class="list-group-item list-group-item-action py-3">
                    çº çº·è°ƒè§£è¿›åº¦æŸ¥è¯¢
                </a>
                <a href="/mediation/upload" class="list-group-item list-group-item-action py-3">
                    å½•åƒ/å½•éŸ³ä¸Šä¼ 
                </a>
                <a href="/mediation/download" class="list-group-item list-group-item-action py-3">
                    å½•åƒ/å½•éŸ³ä¸‹è½½
                </a>
                <a href="/mediation/hotline" class="list-group-item list-group-item-action py-3 text-muted">
                    <small>24å°æ—¶äººå·¥çƒ­çº¿</small>
                </a>
            </div>
        </div>
        
        <div class="alert alert-info mt-3 shadow-sm border-0 small">
            <i class="bi bi-info-circle-fill"></i> æç¤ºï¼š
            ä¸Šä¼ å½•éŸ³å½•åƒå‰ï¼Œè¯·ç¡®ä¿æ–‡ä»¶æ ¼å¼ä¸º MP3 æˆ– MP4ï¼Œå¤§å°ä¸è¶…è¿‡ 500Mã€‚
        </div>
    </div>

    <div class="col-md-9">
        
        <div class="card shadow border-0">
            <div class="card-header bg-white border-bottom py-3 d-flex justify-content-between align-items-center">
                <h4 class="fw-bold text-primary mb-0">ğŸ“ çº çº·è°ƒè§£ç”³è¯·</h4>
                <a href="/mediation" class="btn btn-outline-secondary btn-sm">
                    &lt; è¿”å›ä¸“å®¶åˆ—è¡¨
                </a>
            </div>
            <div class="card-body p-4">
                
                <form action="/mediation/submit" method="post" enctype="multipart/form-data">
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label fw-bold">è¯‰æ±‚äººå§“å <span class="text-danger">*</span></label>
                            <input type="text" name="name" class="form-control form-control-lg" placeholder="è¯·è¾“å…¥çœŸå®å§“å" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-bold">æ€§åˆ«</label>
                            <div class="mt-2">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="gender" id="male" value="male" checked>
                                    <label class="form-check-label" for="male">ç”·</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="gender" id="female" value="female">
                                    <label class="form-check-label" for="female">å¥³</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label fw-bold">è”ç³»ç”µè¯ <span class="text-danger">*</span></label>
                            <div class="input-group">
                                <span class="input-group-text">+86</span>
                                <input type="tel" name="phone" class="form-control form-control-lg" placeholder="è¯·è¾“å…¥æ‰‹æœºå·" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-bold">æ˜¯å¦ä¿å¯†</label>
                            <div class="mt-2">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="secret" id="yes" value="yes">
                                    <label class="form-check-label" for="yes">æ˜¯</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="secret" id="no" value="no" checked>
                                    <label class="form-check-label" for="no">å¦</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-bold">è¯¦ç»†åœ°å€ <span class="text-danger">*</span></label>
                        <input type="text" name="address" class="form-control form-control-lg" placeholder="è¯·å…·ä½“åˆ°ä¹¡é•‡ã€è¡—é“ã€æ‘ç»„ã€é—¨ç‰Œå·" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-bold">çº çº·ç±»å‹ <span class="text-danger">*</span></label>
                        <select class="form-select form-select-lg" name="type">
                            <option selected disabled>è¯·é€‰æ‹©...</option>
                            <option value="1">åˆåŒçº çº·</option>
                            <option value="2">å®…åŸºåœ°çº çº·</option>
                            <option value="3">å€ºåŠ¡çº çº·</option>
                            <option value="4">å…¶ä»–</option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-bold">è¯¦ç»†æè¿° <span class="text-danger">*</span></label>
                        <textarea class="form-control" name="desc" rows="5" placeholder="è¯·è¯¦ç»†æè¿°çº çº·äº‹é¡¹ï¼Œåº”åŒ…å«æ—¶é—´ã€ä¸»ä½“ã€äº‹ä»¶æè¿°ä¸‰ä¸ªè¦ç´ "></textarea>
                    </div>

                    <div class="mb-4">
                        <label class="form-label fw-bold">è¯æ®ä¸Šä¼ </label>
                        <input type="file" name="files" class="form-control" multiple>
                        <div class="form-text text-muted">
                            <i class="bi bi-info-circle"></i> æ”¯æŒå›¾ç‰‡ã€æ–‡æ¡£ã€éŸ³é¢‘ï¼Œæœ€å¤š10ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ª10Mä»¥å†…ã€‚
                        </div>
                    </div>

                    <div class="mb-4">
                        <label class="form-label fw-bold">éªŒè¯ç  <span class="text-danger">*</span></label>
                        <div class="d-flex align-items-center">
                            <input type="text" name="captcha_input" class="form-control form-control-lg me-3" style="width: 150px;" placeholder="ä¸åˆ†å¤§å°å†™" required>
                            
                            <input type="hidden" name="captcha_id" id="captcha_id_field">
                            
                            <div style="cursor: pointer;" onclick="refreshCaptcha()" title="ç‚¹å‡»æ›´æ¢">
                                <img id="captcha_img" src="" alt="åŠ è½½ä¸­..." style="height: 50px; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                            <small class="text-muted ms-2 user-select-none" onclick="refreshCaptcha()" style="cursor: pointer;">çœ‹ä¸æ¸…ï¼Ÿæ¢ä¸€å¼ </small>
                        </div>
                    </div>

                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary btn-lg py-3">ç«‹å³æäº¤ç”³è¯·</button>
                    </div>

                </form>
            </div>
        </div>
    </div>
</div>

<style>
    /* ä¾§è¾¹æ é€‰ä¸­æ ·å¼ï¼šç™½åº•ã€è“å­—ã€å·¦ä¾§è“è¾¹ */
    .sidebar-active {
        background-color: #fff !important;
        color: #0d6efd !important; /* Bootstrap primary color */
        font-weight: bold;
        border-left: 5px solid #0d6efd !important;
        padding-left: 15px !important; /* ç¨å¾®å¾€å³æ¨ä¸€ç‚¹ */
        box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
</style>

<script>
    // ç”Ÿæˆä¸€ä¸ªéšæœº ID (æ¨¡æ‹Ÿ UUID)
    function generateUUID() {
        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
            var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
        });
    }

    // åˆ·æ–°éªŒè¯ç 
    function refreshCaptcha() {
        var oldId = document.getElementById('captcha_id_field').value;
        var newId = generateUUID();
        document.getElementById('captcha_id_field').value = newId;

        var imgUrl = "/mediation/captcha/" + newId + "?old_uid=" + oldId + "&t=" + new Date().getTime();
        document.getElementById('captcha_img').src = imgUrl;
    }

    // é¡µé¢åŠ è½½å®Œæˆåï¼Œè‡ªåŠ¨åˆ·å‡ºä¸€å¼ 
    window.onload = function() {
        refreshCaptcha();
    }
</script>
{% endblock %}
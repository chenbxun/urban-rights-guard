{% extends "base.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">

        <div class="text-center mb-5 mt-4">
            <h2 class="fw-bold text-primary">æ™ºèƒ½å¸æ³•æ¡ˆä¾‹åº“</h2>
            <p class="text-muted">æ±‡é›†æ°‘äº‹ã€åˆ‘äº‹ã€è¡Œæ”¿åŠæ‰§è¡Œç›‘ç£å…¸å‹æ¡ˆä¾‹ | æ™ºèƒ½åŒ¹é…äº‰è®®ç„¦ç‚¹</p>
        </div>

        <div class="card shadow border-0 mb-4" style="border-radius: 15px;">
            <div class="card-body p-4 bg-light" style="border-radius: 15px;">
                <form action="/case/search" method="post" class="d-flex gap-2">
                    <input type="text" name="keyword" class="form-control form-control-lg border-0 shadow-sm" 
                           placeholder="è¾“å…¥æ¡ˆç”±ã€å…³é”®è¯æˆ–å½“äº‹äººï¼Œä¾‹å¦‚ï¼šåˆåŒè¯ˆéª—ã€æ‹†è¿è¡¥å¿..." 
                           value="{{ search_query }}">
                    <button type="submit" class="btn btn-primary btn-lg px-4 shadow-sm">ğŸ” æœç´¢</button>
                </form>
                
                <div class="mt-3 d-flex justify-content-center gap-2 flex-wrap">
                    <span class="text-muted small align-self-center me-1">å¿«é€Ÿç­›é€‰:</span>
                    <a href="/case?category=å…¨éƒ¨" class="badge rounded-pill text-decoration-none {% if current_category == 'å…¨éƒ¨' %}bg-dark{% else %}bg-secondary{% endif %}">å…¨éƒ¨</a>
                    <a href="/case?category=æ°‘äº‹" class="badge rounded-pill text-decoration-none {% if current_category == 'æ°‘äº‹' %}bg-primary{% else %}bg-secondary{% endif %}">ğŸ  æ°‘äº‹</a>
                    <a href="/case?category=åˆ‘äº‹" class="badge rounded-pill text-decoration-none {% if current_category == 'åˆ‘äº‹' %}bg-danger{% else %}bg-secondary{% endif %}">ğŸš” åˆ‘äº‹</a>
                    <a href="/case?category=è¡Œæ”¿" class="badge rounded-pill text-decoration-none {% if current_category == 'è¡Œæ”¿' %}bg-success{% else %}bg-secondary{% endif %}">ğŸ›ï¸ è¡Œæ”¿</a>
                    <a href="/case?category=æ‰§è¡Œç›‘ç£ç±»" class="badge rounded-pill text-decoration-none {% if current_category == 'æ‰§è¡Œç›‘ç£ç±»' %}bg-warning text-dark{% else %}bg-secondary{% endif %}">ğŸ”¨ æ‰§è¡Œç›‘ç£ç±»</a>
                </div>
            </div>
        </div>

        <div class="list-group">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <span class="text-muted">
                    {% if search_query %}
                        æ‰¾åˆ°ç›¸å…³ç»“æœ {{ results|length }} æ¡ (å·²æŒ‰ç›¸å…³åº¦æ’åº)
                    {% else %}
                        æœ€æ–°å…¥åº“æ¡ˆä¾‹
                    {% endif %}
                </span>
            </div>

            {% for item in results %}
            <a href="/case/detail/{{ item.case_no }}" class="list-group-item list-group-item-action p-4 mb-3 border-0 shadow-sm rounded-3 hover-shadow">
                <div class="d-flex w-100 justify-content-between align-items-start">
                    <div>
                        <h5 class="mb-2 fw-bold text-dark">
                            {{ item.title }}
                            {% if item.category == 'æ°‘äº‹' %}
                                <span class="badge bg-primary ms-2" style="font-size: 0.7em;">æ°‘äº‹</span>
                            {% elif item.category == 'åˆ‘äº‹' %}
                                <span class="badge bg-danger ms-2" style="font-size: 0.7em;">åˆ‘äº‹</span>
                            {% elif item.category == 'è¡Œæ”¿' %}
                                <span class="badge bg-success ms-2" style="font-size: 0.7em;">è¡Œæ”¿</span>
                            {% else %}
                                <span class="badge bg-warning text-dark ms-2" style="font-size: 0.7em;">æ‰§è¡Œç›‘ç£ç±»</span>
                            {% endif %}
                        </h5>
                        <small class="text-muted d-block mb-2">æ¡ˆå·ï¼š{{ item.case_no }}</small>
                    </div>
                    {% if item.score %}
                    <span class="badge bg-light text-primary border border-primary">åŒ¹é…åº¦: {{ item.score }}</span>
                    {% endif %}
                </div>
                
                <p class="mb-2 text-secondary" style="font-size: 0.95rem; line-height: 1.6;">
                    {{ item.summary | safe }}
                </p>
                
                <div class="mt-2">
                    {% for keyword in item.keywords %}
                        <span class="badge bg-light text-secondary border me-1">#{{ keyword }}</span>
                    {% endfor %}
                </div>
            </a>
            {% else %}
            <div class="text-center py-5">
                <img src="https://cdn-icons-png.flaticon.com/512/7486/7486747.png" width="100" class="mb-3 opacity-50">
                <p class="text-muted">æš‚æ— ç¬¦åˆæ¡ä»¶çš„æ¡ˆä¾‹ï¼Œè¯·å°è¯•æ›´æ¢å…³é”®è¯ã€‚</p>
            </div>
            {% endfor %}
        </div>

    </div>
</div>

<style>
    .hover-shadow { transition: transform 0.2s; }
    .hover-shadow:hover { transform: translateY(-2px); box-shadow: 0 .5rem 1rem rgba(0,0,0,.1)!important; }
</style>
{% endblock %}